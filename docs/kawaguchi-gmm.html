<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>C kawaguchiの課題についての補足 | 経済学と反事実分析 接触篇 Economics and Counterfactual Analysis: A Contact</title>
  <meta name="description" content="Tokyo.Rの続き" />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="C kawaguchiの課題についての補足 | 経済学と反事実分析 接触篇 Economics and Counterfactual Analysis: A Contact" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tokyo.Rの続き" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="C kawaguchiの課題についての補足 | 経済学と反事実分析 接触篇 Economics and Counterfactual Analysis: A Contact" />
  
  <meta name="twitter:description" content="Tokyo.Rの続き" />
  

<meta name="author" content="ill-identified" />


<meta name="date" content="2020-02-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="boot.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Top</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 概要</a></li>
<li class="chapter" data-level="2" data-path="イントロダクション.html"><a href="イントロダクション.html"><i class="fa fa-check"></i><b>2</b> イントロダクション</a><ul>
<li class="chapter" data-level="2.1" data-path="イントロダクション.html"><a href="イントロダクション.html#構造推定とは"><i class="fa fa-check"></i><b>2.1</b> 構造推定とは</a><ul>
<li class="chapter" data-level="2.1.1" data-path="イントロダクション.html"><a href="イントロダクション.html#構造方程式モデリング"><i class="fa fa-check"></i><b>2.1.1</b> 構造方程式モデリング</a></li>
<li class="chapter" data-level="2.1.2" data-path="イントロダクション.html"><a href="イントロダクション.html#構造時系列モデル"><i class="fa fa-check"></i><b>2.1.2</b> 構造時系列モデル</a></li>
<li class="chapter" data-level="2.1.3" data-path="イントロダクション.html"><a href="イントロダクション.html#構造型モデル"><i class="fa fa-check"></i><b>2.1.3</b> 構造型モデル</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="イントロダクション.html"><a href="イントロダクション.html#因果推論と何が違うのか"><i class="fa fa-check"></i><b>2.2</b> 因果推論と何が違うのか</a></li>
<li class="chapter" data-level="2.3" data-path="イントロダクション.html"><a href="イントロダクション.html#今回取り組む問題"><i class="fa fa-check"></i><b>2.3</b> 今回取り組む問題</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="どう推定するか.html"><a href="どう推定するか.html"><i class="fa fa-check"></i><b>3</b> どう推定するか</a><ul>
<li class="chapter" data-level="3.1" data-path="どう推定するか.html"><a href="どう推定するか.html#なぜ生産関数を知りたいのか"><i class="fa fa-check"></i><b>3.1</b> なぜ生産関数を知りたいのか</a></li>
<li class="chapter" data-level="3.2" data-path="どう推定するか.html"><a href="どう推定するか.html#パネルデータ分析と観測されない効果"><i class="fa fa-check"></i><b>3.2</b> パネルデータ分析と観測されない効果</a></li>
<li class="chapter" data-level="3.3" data-path="どう推定するか.html"><a href="どう推定するか.html#動学パネルデータ分析"><i class="fa fa-check"></i><b>3.3</b> 動学パネルデータ分析</a></li>
<li class="chapter" data-level="3.4" data-path="どう推定するか.html"><a href="どう推定するか.html#企業内部の意思決定を考える"><i class="fa fa-check"></i><b>3.4</b> 企業内部の意思決定を考える</a></li>
<li class="chapter" data-level="3.5" data-path="どう推定するか.html"><a href="どう推定するか.html#opモデルの回帰モデルとしての意味"><i class="fa fa-check"></i><b>3.5</b> OPモデルの回帰モデルとしての意味</a></li>
<li class="chapter" data-level="3.6" data-path="どう推定するか.html"><a href="どう推定するか.html#モデルの事後診断"><i class="fa fa-check"></i><b>3.6</b> モデルの事後診断</a></li>
<li class="chapter" data-level="3.7" data-path="どう推定するか.html"><a href="どう推定するか.html#op法以降の研究"><i class="fa fa-check"></i><b>3.7</b> OP法以降の研究</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-での実装.html"><a href="r-での実装.html"><i class="fa fa-check"></i><b>4</b> R での実装</a><ul>
<li class="chapter" data-level="4.1" data-path="r-での実装.html"><a href="r-での実装.html#データのとり方"><i class="fa fa-check"></i><b>4.1</b> データのとり方</a></li>
<li class="chapter" data-level="4.2" data-path="r-での実装.html"><a href="r-での実装.html#beta_lphiの識別"><i class="fa fa-check"></i><b>4.2</b> <span class="math inline">\(\beta_{L},\phi\)</span>の識別</a></li>
<li class="chapter" data-level="4.3" data-path="r-での実装.html"><a href="r-での実装.html#存続確率の推定"><i class="fa fa-check"></i><b>4.3</b> 存続確率の推定</a></li>
<li class="chapter" data-level="4.4" data-path="r-での実装.html"><a href="r-での実装.html#beta_abeta_kの推定"><i class="fa fa-check"></i><b>4.4</b> <span class="math inline">\(\beta_{A},\beta_{K}\)</span>の推定</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="結果.html"><a href="結果.html"><i class="fa fa-check"></i><b>5</b> 結果</a></li>
<li class="chapter" data-level="6" data-path="まとめ.html"><a href="まとめ.html"><i class="fa fa-check"></i><b>6</b> まとめ</a></li>
<li class="appendix"><span><b>補遺</b></span></li>
<li class="chapter" data-level="A" data-path="init.html"><a href="init.html"><i class="fa fa-check"></i><b>A</b> 数値計算上に関係する実装上の注意</a></li>
<li class="chapter" data-level="B" data-path="boot.html"><a href="boot.html"><i class="fa fa-check"></i><b>B</b> ブートストラップ標準誤差</a></li>
<li class="chapter" data-level="C" data-path="kawaguchi-gmm.html"><a href="kawaguchi-gmm.html"><i class="fa fa-check"></i><b>C</b> kawaguchiの課題についての補足</a><ul>
<li class="chapter" data-level="C.1" data-path="kawaguchi-gmm.html"><a href="kawaguchi-gmm.html#gmmパッケージの解説"><i class="fa fa-check"></i><b>C.1</b> <code>gmm</code>パッケージの解説</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">経済学と反事実分析 接触篇 Economics and Counterfactual Analysis: A Contact</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="kawaguchi-gmm" class="section level1">
<h1><span class="header-section-number">C</span> kawaguchiの課題についての補足</h1>
<p>Olleyらの方法に倣えば非線形最小二乗法として係数<span class="math inline">\(\beta_{A},\beta_{K}\)</span>を求める必要があるが, 課題では退出行動を省略し, <span class="math inline">\(\omega_{t}\)</span>の構造もシンプルなためOlleyらのような複雑な式の導出はなく, <strong>非線形一般化モーメント法</strong> (非線形GMM)で推定することを課している. GMMの解説はすくなく, 非線形GMMとなるとなおさらなので<a href="#fn49" class="footnote-ref" id="fnref49"><sup>49</sup></a>, ここで少し脱線して課題では何をやっているのかを書いておく.</p>
<p>練習用データは<span class="math inline">\(\omega_{t}\)</span>をAR(1)過程の乱数として生成しているので, 課題では係数<span class="math inline">\(\alpha\)</span>は未知であるもののAR(1)であることは分かっているという前提である. つまり, 以下のように仮定している<a href="#fn50" class="footnote-ref" id="fnref50"><sup>50</sup></a>ので,
<span class="math display">\[\begin{aligned}
h(\omega_{t+1})= &amp; \alpha\omega_{t}+\nu_{t},\\
\nu_{t}\sim &amp; \mathcal{N}(0,\sigma_{\nu}^{2})\forall t\end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned}
\hat{\xi}_{t+1}:= &amp; \omega_{t+1}-\alpha\left(\hat{\phi}(k_{t},\mathit{inv}_{t})-\beta_{A}-\beta_{K}k_{t+1}\right)\end{aligned}\]</span>
とすると,
<span class="math display">\[\begin{aligned}
y_{t+1}= &amp; \beta_{L}l_{t+1}+\beta_{A}+\beta_{K}k_{t+1}+\alpha\left(\hat{\phi}(k_{t},\mathit{inv}_{t})-\beta_{A}-\beta_{K}k_{t+1}\right)+\hat{\xi}_{t+1}+\varepsilon_{t+1}\end{aligned}\]</span>
となり, これを変形すると以下のようになる.
<span class="math display">\[\begin{aligned}
\hat{\xi}_{t+1}+\varepsilon_{t+1}= &amp; y_{t+1}-\hat{\beta}_{L}l_{t+1}-\beta_{A}-\beta_{K}k_{t+1}-\alpha\left(\hat{\phi}(k_{t},\mathit{inv}_{t})-\beta_{A}-\beta_{K}k_{t+1}\right)\end{aligned}\]</span>
既に書いた仮定では <span class="math inline">\(\hat{\xi}_{t+1}+\varepsilon_{t+1}\)</span>は同時点のいくつかの変数と相関する可能性が残るが同時点の<span class="math inline">\(k_{t+1}\)</span>および1時点前の<span class="math inline">\(k_{t},\mathit{inv}_{i,t}\)</span>と無相関なので以下のような<strong>モーメント条件</strong>が成り立つ.
<span class="math display">\[\begin{aligned}
\mathrm{E}(\hat{\xi}_{t+1}+\varepsilon_{t+1})\begin{bmatrix}k_{t+1}\\
k_{t}\\
\mathit{inv}_{t}
\end{bmatrix}= &amp; \mathbf{0}\end{aligned}\]</span></p>
<p><span class="math inline">\(\hat{\xi}_{t}+\varepsilon_{t}\)</span>にはパラメータに対して非線形な項が含まれるので非線形モデルということになる. 線形モデルの場合は単にGMMと呼ばれ, 今回のような<strong>非線形モーメント条件</strong>を特定した場合を<strong>非線形GMM</strong>と呼び, ニュートン法などの非線形最適化の方法で計算することになる. なお計算には新たに<span class="math inline">\(y_{t}-\hat{\beta}_{L}l_{t}\)</span>,<span class="math inline">\(\hat{\phi}_{t}\)</span>, <span class="math inline">\(k_{t},\mathit{inv}_{t}\)</span>のラグ項が必要になるが, これらは既にで作成している.</p>
<p>RでGMM推定法を計算するパッケージには <code>gmm</code>, <code>plm</code>がある<a href="#fn51" class="footnote-ref" id="fnref51"><sup>51</sup></a>. 後者の<code>plm</code>はGMMだけでなく, FE/REモデルなどパネルデータを想定したモデルの計算用関数が用意されている. 今回もパネルデータを利用しているが, 個別効果を想定していないため<code>plm</code>を必ず使わなければならないわけではない. 実際のところ, <code>plm::pgmm()</code>でできるGMMは既に少しだけ言及したArellano-Bond/Blundell-Bondの動学パネルデータモデルの推定だけであるので, 今回のような<strong>非線形GMMには使えない</strong>. 一方で<code>gmm</code>パッケージは非線形GMMにも対応しているので, 今回はこちらを使う.</p>
<p>また, GMMを使う場合も標準誤差はブートストラップ法で計算する必要がある. しかしカーネル回帰は非常に時間がかかるため, 100回も1000回も繰り返すのは現実的ではない. 今回時間がかかるのは主に最適バンド幅を計算する<code>npplregbw()</code>の実行なので, 最初の計算で得たバンド幅を全てのブートストラップ標本で共用することにした. しかし, <code>np</code>パッケージは<strong>引数に対する挙動がかなり意味不明で混乱を招く</strong>. 所与のバンド幅でデータを変えて再計算したい場合の方法が不明瞭である. いろいろ試したが, <code>data</code>に与えるだけではバンド幅計算時の結果がそのまま出力されるようだ. <code>txdat</code>, <code>tydat</code>, <code>tzdat</code>にそれぞれ新しい数値を与える必要があるらしい.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">npplreg</span>(<span class="dt">bws =</span> bw,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">        <span class="dt">txdat =</span> <span class="kw">as.data.frame</span>(df_sample[, <span class="st">&quot;l&quot;</span>]),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">        <span class="dt">tydat =</span> df_sample<span class="op">$</span>y,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">        <span class="dt">tzdat =</span> <span class="kw">as.data.frame</span>(df_sample[, <span class="kw">c</span>(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;inv&quot;</span>)]))</a></code></pre></div>
<div id="gmmパッケージの解説" class="section level2">
<h2><span class="header-section-number">C.1</span> <code>gmm</code>パッケージの解説</h2>
<p><code>gmm</code>の使い方はヘルプを見れば十分なのだが, タダで見られてかつ日本語のGMMの解説は少なく, 非線形GMMの解説は一層少ない. そういうものを求める人のためにここで少しだけ解説しておく. まず, 線形の場合は<code>lm()</code>などと同じように<code>formula</code>オブジェクトでモーメント条件を指定できる.
例えば,
<span class="math display">\[\begin{aligned}
\mathrm{E}(y_{i}-\alpha-\beta x_{i})\begin{bmatrix}z_{i,1}\\
z_{i,2}\\
z_{i,3}
\end{bmatrix}= &amp; \mathbf{0}\end{aligned}\]</span>
のようなモーメント条件をもとにGMM推定したい場合は,</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">gmm</span>(y<span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">|</span><span class="st"> </span>z1 <span class="op">+</span><span class="st"> </span>z2 <span class="op">+</span><span class="st"> </span>z3, <span class="dt">x =</span> data)</a></code></pre></div>
<p>となる<a href="#fn52" class="footnote-ref" id="fnref52"><sup>52</sup></a>.
<code>data</code> はデータフレームまたは<code>matrix</code>で与える.</p>
<p>非線形モデルの場合はこのようにモデルを<code>formula</code>で表現できないため, 代わりに標本モーメントを返す関数を与える. この関数関数は第1, 第2引数にそれぞれパラメータと入力データを与て<span class="math inline">\(N\times q\)</span>行列を返すものが要求される. <span class="math inline">\(N\)</span>は入力データの件数, <span class="math inline">\(q\)</span>はモーメント式の本数である. つまり上記の期待値の部分で,
<span class="math display">\[\begin{aligned}
m_{i}(\alpha,\beta;x_{i}):= &amp; (y_{i}-\alpha-\beta x_{i})\begin{bmatrix}z_{i,1}\\
z_{i,2}\\
z_{i,3}
\end{bmatrix}\end{aligned}\]</span>
という部分であり, 返す行列は
<span class="math display">\[\begin{aligned}
\begin{bmatrix}m_{1}z_{1,1} &amp; m_{1}z_{1,2} &amp; m_{1}z_{1,3}\\
m_{2}z_{2,1} &amp; m_{2}z_{2,2} &amp; m_{2}z_{2,3}\\
\vdots &amp; \vdots &amp; \vdots\\
m_{N}z_{N,1} &amp; m_{N}z_{N,2} &amp; m_{Z}z_{N,3}
\end{bmatrix}\end{aligned}\]</span>
という形になる.</p>
<p>非線形GMMとは<span class="math inline">\(m_{i}(\theta,x_{i})\)</span>の部分について, 例えば<span class="math inline">\(m_{i}(\theta,x_{i}):=(y_{i}-\alpha-\gamma\beta x_{i})\begin{bmatrix}z_{i,1} &amp; \cdots &amp; z_{i,3}\end{bmatrix}^{\top}\)</span>のような非線形関数の場合を指す.
この<span class="math inline">\(m_{i}\)</span>の標本平均の重み付きノルム<span class="math inline">\(F_{n}\)</span>を目的関数として最小化するのがGMMである<a href="#fn53" class="footnote-ref" id="fnref53"><sup>53</sup></a>.
<span class="math display">\[\begin{aligned}
F_{n}(\alpha,\beta)= &amp; \left[\frac{1}{N}\sum_{i=1}^{N}m_{i}(\theta,x_{i})\right]^{\top}\hat{\mathbf{W}}^{-1}\left[\frac{1}{N}\sum_{i=1}^{N}m_{i}(\theta,x_{i})\right]\end{aligned}\]</span></p>
<p>非線形GMMはニュートン法でも計算できるため, 目的関数<span class="math inline">\(F_{n}(\cdots)\)</span>を計算する関数さえ作れば, 係数だけなら<code>gmm</code>パッケージを使わなくとも<code>optim()</code>で簡単に推定できる.
そこで, 念のため<code>optim()</code>も使って検算するのも良いだろう.</p>

<div id="refs" class="references">
<div>
<p>Ackerberg, Daniel A., Kevin Caves, and Garth Frazer. 2015. “Identification Properties of Recent Production Function Estimators.” <em>Econometrica</em> 83 (6): 2411–51. <a href="https://doi.org/10.3982/ECTA13408">https://doi.org/10.3982/ECTA13408</a>.</p>
</div>
<div>
<p>Anderson, T. W., and Cheng Hsiao. 1981. “Estimation of Dynamic Models with Error Components.” <em>Journal of the American Statistical Association</em> 76 (375): 598–606. <a href="https://doi.org/10.1080/01621459.1981.10477691">https://doi.org/10.1080/01621459.1981.10477691</a>.</p>
</div>
<div>
<p>———. 1982. “Formulation and Estimation of Dynamic Models Using Panel Data.” <em>Journal of Econometrics</em> 18 (1): 47–82. <a href="https://doi.org/10.1016/0304-4076(82)90095-1">https://doi.org/10.1016/0304-4076(82)90095-1</a>.</p>
</div>
<div>
<p>Arellano, Manuel, and Stephen Bond. 1991. “Some Tests of Specification for Panel Data: Monte Carlo Evidence and an Application to Employment Equations.” <em>The Review of Economic Studies</em> 58 (2): 277. <a href="https://doi.org/10.2307/2297968">https://doi.org/10.2307/2297968</a>.</p>
</div>
<div>
<p>Blundell, R, and Steven Bond. 1998. “Initial Conditions and Moment Restrictions in Dynamic Panel Data Models.” <em>Journal of Econometrics</em> 87 (1): 115–43. <a href="https://doi.org/10.1016/S0304-4076(98)00009-8">https://doi.org/10.1016/S0304-4076(98)00009-8</a>.</p>
</div>
<div>
<p>Blundell, Richard, and James L. Powell. 2003. “Endogeneity in Nonparametric and Semiparametric Regression Models.” In <em>Advances in Economics and Econometrics</em>, edited by Mathias Dewatripont, Lars Peter Hansen, and Stephen J. Turnovsky, 312–57. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511610257.011">https://doi.org/10.1017/CBO9780511610257.011</a>.</p>
</div>
<div>
<p>Cameron, AC, and PK Trivedi. 2005. <em>Microeconometrics: Methods and Applications</em>. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CBO9781107415324.004">https://doi.org/10.1017/CBO9781107415324.004</a>.</p>
</div>
<div>
<p>Efron, B. 1979. “Bootstrap Methods: Another Look at the Jackknife.” <em>The Annals of Statistics</em> 7 (1): 1–26. <a href="https://doi.org/10.1214/aos/1176344552">https://doi.org/10.1214/aos/1176344552</a>.</p>
</div>
<div>
<p>Griliches, Zvi, and Jacques Mairesse. 1999. “Production Functions: The Search for Identification.” In <em>Econometrics and Economic Theory in the 20th Century</em>, edited by Steinar Strom, 169–203. Cambridge: Cambridge University Press. <a href="https://doi.org/10.1017/CCOL521633230.006">https://doi.org/10.1017/CCOL521633230.006</a>.</p>
</div>
<div>
<p>Hastie, Trevor, Robert Tibshriani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining, Inference, and Prediction</em>. 2nd ed. Springer. <a href="https://web.stanford.edu/~hastie/ElemStatLearn/">https://web.stanford.edu/~hastie/ElemStatLearn/</a>.</p>
</div>
<div>
<p>Hayashi, Fumio. 2000. <em>Econometrics</em>. Princeton: Princeton University Press.</p>
</div>
<div>
<p>Igami, Mitsuru. 2018. “Artificial Intelligence as Structural Estimation: Economic Interpretations of Deep Blue, Bonanza, and AlphaGo.” <a href="http://arxiv.org/abs/1710.10967">http://arxiv.org/abs/1710.10967</a>.</p>
</div>
<div>
<p>Kawaguchi, Kohei. 2019. “ECON 6120I Topics in Empirical Industrial Organization.” <a href="https://kohei-kawaguchi.github.io/EmpiricalIO/">https://kohei-kawaguchi.github.io/EmpiricalIO/</a>.</p>
</div>
<div>
<p>Levinsohn, James, and Amil Petrin. 2003. “Estimating Production Functions Using Inputs to Control for Unobservables.” <em>Review of Economic Studies</em> 70 (2): 317–41. <a href="https://doi.org/10.1111/1467-937X.00246">https://doi.org/10.1111/1467-937X.00246</a>.</p>
</div>
<div>
<p>Li, Qi, and Jeffrey Scott Racine. 2007. <em>Nonparametric Econometrics: Theory and Practice</em>. Princeton, N.J: Princeton University Press.</p>
</div>
<div>
<p>Lucas, Robert E. 1976. “Econometric Policy Evaluation: A Critique.” <em>Carnegie-Rochester Confer. Series on Public Policy</em> 1 (C): 19–46. <a href="https://doi.org/10.1016/S0167-2231(76)80003-6">https://doi.org/10.1016/S0167-2231(76)80003-6</a>.</p>
</div>
<div>
<p>Lütkepohl, Helmut. 2007. <em>New Introduction to Multiple Time Series Analysis</em>. 1. ed., corr. 2. printing. Berlin: Springer.</p>
</div>
<div>
<p>Mairesse, Jacques. 1990. “Time-Series and Cross-Sectional Estimates on Panel Data: Why Are They Different and Why Should They Be Equal?” In <em>Panel Data and Labor Market Studies</em>, edited by Joop Hartog, Geert Ridder, and Jules Theeuwes, 81–95. North-Holland: Elsevier Science Publishers B.V.</p>
</div>
<div>
<p>Mas-Colell, Andreu, Michael D. Whinston, and Jery R. Green. 1995. <em>Microeconomic Theory</em>. Oxford University Press.</p>
</div>
<div>
<p>Merton, Robert C. 1974. “On the Pricing of Corporate Debt: The Risk Structure of Interest Rates.” <em>The Journal of Finance</em> 29 (2): 449. <a href="https://doi.org/10.2307/2978814">https://doi.org/10.2307/2978814</a>.</p>
</div>
<div>
<p>Olley, G. Steven, and Ariel Pakes. 1996. “The Dynamics of Productivity in the Telecommunications Equipment Industry.” <em>Econometrica</em> 64 (6): 1263–97. <a href="https://doi.org/10.2307/2171831">https://doi.org/10.2307/2171831</a>.</p>
</div>
<div>
<p>Pakes, Ariel, and Steven Olley. 1995. “A Limit Theorem for a Smooth Class of Semiparametric Estimators.” <em>Journal of Econometrics</em> 65 (1): 295–332. <a href="https://doi.org/10.1016/0304-4076(94)01605-Y">https://doi.org/10.1016/0304-4076(94)01605-Y</a>.</p>
</div>
<div>
<p>Reiss, Peter C., and Frank A. Wolak. 2007. “Structural Econometric Modeling: Rationales and Examples from Industrial Organization.” In <em>Handbook of Econometrics</em>, edited by James J. Heckman and Edward E. Leamer, 6:4277–4415. Handbook of Econometrics. Elsevier. <a href="https://doi.org/10.1016/S1573-4412(07)06064-3">https://doi.org/10.1016/S1573-4412(07)06064-3</a>.</p>
</div>
<div>
<p>Scott, Steven L., and Hal R. Varian. 2014. “Predicting the Present with Bayesian Structural Time Series.” <em>International Journal of Mathematical Modelling and Numerical Optimisation</em> 5 (1/2): 4. <a href="https://doi.org/10.1504/IJMMNO.2014.059942">https://doi.org/10.1504/IJMMNO.2014.059942</a>.</p>
</div>
<div>
<p>Varian, Hal R. 1992. <em>Microeconomic Analysis</em>. 3rd ed. New York: Norton.</p>
</div>
<div>
<p>Wooldridge, Jeffrey M. 2010. <em>Econometric Analysis of Cross Section and Panel Data</em>. 2nd ed. The MIT Press. <a href="https://mitpress.mit.edu/books/econometric-analysis-cross-section-and-panel-data">https://mitpress.mit.edu/books/econometric-analysis-cross-section-and-panel-data</a>.</p>
</div>
<div>
<p>中島, 上智, and 渡部敏明. 2012. “時変ベクトル自己回帰モデル -サーベイと日本のマクロデータへの応用-.” <em>経済研究</em> 63 (3): 193–208. <a href="https://doi.org/10.15057/25864">https://doi.org/10.15057/25864</a>.</p>
</div>
<div>
<p>久保, 拓哉. 2012. <em>データ解析のための統計モデリング入門</em>. 岩波書店.</p>
</div>
<div>
<p>北川, 源四郎. 2005. <em>時系列解析入門</em>. 岩波書店.</p>
</div>
<div>
<p>北村, 行伸. 2016. “応用ミクロ計量経済学の手法と論点.” In <em>経済セミナー増刊 進化する経済学の実証分析</em>, 28–36. 日本評論社. <a href="http://www.ier.hit-u.ac.jp/~kitamura/PDF/A254.pdf">http://www.ier.hit-u.ac.jp/~kitamura/PDF/A254.pdf</a>.</p>
</div>
<div>
<p>千木良, 弘朗, 早川和彦, and 山本拓. 2011. <em>動学的パネルデータ分析</em>. 東京: 知泉書館.</p>
</div>
<div>
<p>坂本, 亘, 井筒理人, and 白旗慎吾. 2009. “罰則付きスプラインによる非線形回帰構造の推測.” <em>計算機統計学</em> 21 (1-2): 55–94. <a href="https://doi.org/10.20551/jscswabun.21.1-2_55">https://doi.org/10.20551/jscswabun.21.1-2_55</a>.</p>
</div>
<div>
<p>奥井, 亮. 2016. “動学的パネルデータモデル.” <a href="http://www.sigmath.es.osaka-u.ac.jp/~Estat/h28_datascience2/okui_handai28_v2.pdf">http://www.sigmath.es.osaka-u.ac.jp/~Estat/h28_datascience2/okui_handai28_v2.pdf</a>.</p>
</div>
<div>
<p>星野, 崇宏. 2009. <em>調査観察データの統計科学 –因果推論・選択バイアス・データ融合</em>. 岩波書店.</p>
</div>
<div>
<p>沖本, 竜義. 2010. <em>経済・ファイナンスデータの計量時系列分析</em>. 朝倉書店.</p>
</div>
<div>
<p>渡部, 敏明. 2016. “ルーカス批判とマクロ計量分析.” In <em>経済セミナー増刊 進化する経済学の実証分析</em>, 37–41. 日本評論社.</p>
</div>
<div>
<p>西村, 和雄. 1990. <em>ミクロ経済学</em>. 東洋経済新報社.</p>
</div>
<div>
<p>高井, 啓二, 星野崇宏, and 野間久史. 2016. <em>欠測データの統計科学</em>. 岩波書店.</p>
</div>
<div>
<p>高橋, 将宜, and 渡辺美智子. 2017. <em>欠測データ処理 — R による単一代入法と多重代入法—</em>. 統計学 One Point 5. 共立出版.</p>
</div>
</div>
</div>
</div>

































































<div class="footnotes">
<hr />
<ol start="49">
<li id="fn49"><p>非線形GMMは <span class="citation">Hayashi (<a href="#ref-hayashi2000Econometrics">2000</a>)</span> を始め大学院向け標準レベルの教科書なら必ずと言っていいほど載っているが, 日本語の教科書では線形GMMまでしか書いていないことが多い. 私が以前書いたブログ記事でも肝心の非線形GMMの説明がなかった. どんなモーメント条件であっても求められるわけではなく, ニュートン法は目的関数が凹関数でなければ一意な解を得られない. 実際には一致性や漸近分布を保証するためにさらにいくつかの十分条件を考える必要がある. それらの議論も詳しくは教科書を参照してほしい.<a href="kawaguchi-gmm.html#fnref49" class="footnote-back">↩</a></p></li>
<li id="fn50"><p>課題文にも書いてあるように, 本来は<span class="math inline">\(\omega_{t}\)</span>の決定メカニズムを知ることは難しいため現実の問題に対してこのような強い仮定を置くことは好ましくない.<a href="kawaguchi-gmm.html#fnref50" class="footnote-back">↩</a></p></li>
<li id="fn52"><p><code>formula</code>の構文はデフォルトで定数項を加えるため, <code>1</code> は必須ではない. そもそも<code>formula</code>の構文が分からない場合は 『<a href="http://cse.naro.affrc.go.jp/takezawa/r-tips/r/71.html">71. 回帰分析と重回帰分析 - R-Source</a>』や私が以前書いた『<a href="http://ill-identified.hatenablog.com/entry/2017/04/30/004258">予測モデルを作るには formula を活用せよ</a>』などを参照<a href="kawaguchi-gmm.html#fnref52" class="footnote-back">↩</a></p></li>
<li id="fn53"><p>典型的なGMMでは重み行列<span class="math inline">\(\hat{\mathbf{W}}\)</span>に共分散行列の推定値を与えるが, 課題では簡略化のため単位行列を与えるよう指示がある. 単位行列の場合, 線形モデルでいう2段階最小二乗法 (2SLS) と等価な計算になる. 重み行列の役割は主に標準誤差の縮小なのでブートストラップ法で計算する今回のケースではさほど重要ではない.<a href="kawaguchi-gmm.html#fnref53" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="boot.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["20200120_econ.pdf"],
"toc": {
"collapse": "subsection",
"download": "pdf"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
